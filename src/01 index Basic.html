<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stipend Analysis Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0a0a0a;
            color: white;
            margin: 0;
            padding: 20px;
        }
        
        .dashboard {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: left;
            margin-bottom: 40px;
        }
        
        .chart-container {
            background: #1a1a1a;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .chart-title {
            font-size: 18px;
            /* font-weight: bold; */
            margin-bottom: 15px;
            color: #ffffff;
        }
        
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
/* Define color variables - update these to match your legend colors */
:root {
    --stipend-color: #fa8080;          /* Actual stipend line color */
    --buying-power-1990: #4ecdc4;      /* 1990 buying power color */
    --buying-power-2000: #45b7d1;      /* 2000 buying power color */
    --buying-power-2007: #bf7bff;      /* 2007 buying power color */
    --buying-power-2015: #ffd93d;      /* 2015 buying power color */
    --all-button-color: #bcbcbc;       /* Grey for "Show All" button */
    --default-border: #6c757d;         /* Default border color */
}

/* Default button styles */
button {
    background: transparent;
    color: var(--default-border);
    border: 2px solid var(--default-border);
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}

/* Individual button colors */
#btn-all {
    color: var(--all-button-color);
    border-color: var(--all-button-color);
}

#btn-all.active {
    background: var(--all-button-color);
    color: black;
}

#btn-actual {
    color: var(--stipend-color);
    border-color: var(--stipend-color);
}

#btn-actual.active {
    background: var(--stipend-color);
    color: black;
}

#btn-1990 {
    color: var(--buying-power-1990);
    border-color: var(--buying-power-1990);
}

#btn-1990.active {
    background: var(--buying-power-1990);
    color: black;
}

#btn-2000 {
    color: var(--buying-power-2000);
    border-color: var(--buying-power-2000);
}

#btn-2000.active {
    background: var(--buying-power-2000);
    color: black;
}

#btn-2007 {
    color: var(--buying-power-2007);
    border-color: var(--buying-power-2007);
}

#btn-2007.active {
    background: var(--buying-power-2007);
    color: black;
}

#btn-2015 {
    color: var(--buying-power-2015);
    border-color: var(--buying-power-2015);
}

#btn-2015.active {
    background: var(--buying-power-2015);
    color: black;
}
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid #333;
        }

        /* Grid styles */
        .grid line {
            stroke: #333;
            stroke-opacity: 0.7;
            stroke-width: 1;
        }
        
        .grid .domain {
            stroke: none;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>IIT Bombay's Stipend Analysis</h1>
            
        </div>
        
        <!-- <div class="chart-container">
            <div class="chart-title">Actual Stipend Over Time</div>
            <svg id="stipend-chart"></svg>
        </div> -->
        
        <div class="chart-container">
            <div class="chart-title">Analyzing <b>stipend trends</b> and <b>change in buying power</b> (inflation rate) from 1990-2024</div>
            <div style="font-size: 12px; margin-bottom: 10px; color: #ccc;">
                <p>Stipends were adjusted during the years 1999, 2007 and 2015 to match the inflation (buying power) during that year. 
                    <br> The graph tries to see the change in buying power of the stipend from the year it was adjusted. </p>
                <i style="color: #ffd93d;">Note: 
                    <br> Click buttons to toggle visibility of different inflation-adjusted stipend lines.
                    <br> Hover over points to see exact values.
                    <br>
                </i>
            </div>
            <div class="controls">
                <button id="btn-all" class="active">Show All</button>
                <button id="btn-actual">Actual Stipend</button>
                <button id="btn-1990">Inflation since 1990</button>
                <button id="btn-2000">Inflation since 1999</button>
                <button id="btn-2007">Inflation since 2007</button>
                <button id="btn-2015">Inflation since 2015</button>
            </div>
            <svg id="multi-line-chart"></svg>
            <!-- <div class="legend" id="legend"></div> -->
        </div>
        
        <!-- <div class="chart-container">
            <div class="chart-title">Bar Chart: Current vs Required Stipend (2024)</div>
            <svg id="bar-chart"></svg>
        </div> -->
    </div>
    
    <div class="tooltip" id="tooltip"></div>

    <script>
        const data = [
            { year: "1990", stipend: 2500, buyingPower1990: 2500 },
            { year: "1991", stipend: 2500, buyingPower1990: 2846.76 },
            { year: "1992", stipend: 2500, buyingPower1990: 3182.33 },
            { year: "1993", stipend: 2500, buyingPower1990: 3383.67 },
            { year: "1994", stipend: 2500, buyingPower1990: 3730.43 },
            { year: "1995", stipend: 2500, buyingPower1990: 4111.86 },
            { year: "1996", stipend: 2500, buyingPower1990: 4480.98 },
            { year: "1997", stipend: 2500, buyingPower1990: 4802.01 },
            { year: "1998", stipend: 2500, buyingPower1990: 5437.36 },
            { year: "1999", stipend: 5000, buyingPower1990: 5691.28, buyingPower2000: 5000.00 },
            { year: "2000", stipend: 5000, buyingPower1990: 5919.46, buyingPower2000: 5228.19 },
            { year: "2001", stipend: 5000, buyingPower1990: 6143.18, buyingPower2000: 5451.90 },
            { year: "2002", stipend: 5000, buyingPower1990: 6407.16, buyingPower2000: 5715.88 },
            { year: "2003", stipend: 5000, buyingPower1990: 6651.01, buyingPower2000: 5959.73 },
            { year: "2004", stipend: 5000, buyingPower1990: 6901.57, buyingPower2000: 6210.29 },
            { year: "2005", stipend: 5000, buyingPower1990: 7194.63, buyingPower2000: 6503.36 },
            { year: "2006", stipend: 5000, buyingPower1990: 7611.67, buyingPower2000: 6920.39 },
            { year: "2007", stipend: 8000, buyingPower1990: 8096.75, buyingPower2000: 7405.48, buyingPower2007: 8000.00 },
            { year: "2008", stipend: 8000, buyingPower1990: 8772.77, buyingPower2000: 8081.50, buyingPower2007: 8676.02 },
            { year: "2009", stipend: 8000, buyingPower1990: 9727.45, buyingPower2000: 9036.18, buyingPower2007: 9630.70 },
            { year: "2010", stipend: 8000, buyingPower1990: 10893.72, buyingPower2000: 10202.44, buyingPower2007: 10796.97 },
            { year: "2011", stipend: 8000, buyingPower1990: 11864.54, buyingPower2000: 11173.27, buyingPower2007: 11767.79 },
            { year: "2012", stipend: 8000, buyingPower1990: 12989.18, buyingPower2000: 12297.91, buyingPower2007: 12892.43 },
            { year: "2013", stipend: 8000, buyingPower1990: 14290.42, buyingPower2000: 13599.15, buyingPower2007: 14193.67 },
            { year: "2014", stipend: 8000, buyingPower1990: 15242.97, buyingPower2000: 14551.70, buyingPower2007: 15146.22 },
            { year: "2015", stipend: 12400, buyingPower1990: 15990.94, buyingPower2000: 15299.67, buyingPower2007: 15894.19, buyingPower2015: 12400.00 },
            { year: "2016", stipend: 12400, buyingPower1990: 16782.21, buyingPower2000: 16090.93, buyingPower2007: 16685.46, buyingPower2015: 13191.27 },
            { year: "2017", stipend: 12400, buyingPower1990: 17340.75, buyingPower2000: 16649.47, buyingPower2007: 17244.00, buyingPower2015: 13749.81 },
            { year: "2018", stipend: 12400, buyingPower1990: 18023.77, buyingPower2000: 17332.50, buyingPower2007: 17927.02, buyingPower2015: 14432.83 },
            { year: "2019", stipend: 12400, buyingPower1990: 18695.97, buyingPower2000: 18004.69, buyingPower2007: 18599.22, buyingPower2015: 15105.03 },
            { year: "2020", stipend: 12400, buyingPower1990: 19934.28, buyingPower2000: 19243.01, buyingPower2007: 19837.53, buyingPower2015: 16343.34 },
            { year: "2021", stipend: 12400, buyingPower1990: 20957.19, buyingPower2000: 20265.92, buyingPower2007: 20860.44, buyingPower2015: 17366.25 },
            { year: "2022", stipend: 12400, buyingPower1990: 22361.12, buyingPower2000: 21669.85, buyingPower2007: 22264.37, buyingPower2015: 18770.18 },
            { year: "2023", stipend: 12400, buyingPower1990: 23624.34, buyingPower2000: 22933.06, buyingPower2007: 23527.58, buyingPower2015: 20033.39 },
            { year: "2024", stipend: 12400, buyingPower1990: 24794.46, buyingPower2000: 24103.18, buyingPower2007: 24697.71, buyingPower2015: 21203.52 }
        ];

        // Color scheme
        const colors = {
            stipend: '#ff6b6b',
            buyingPower1990: '#4ecdc4',
            buyingPower2000: '#45b7d1',
            buyingPower2007: '#bf7bff',
            buyingPower2015: '#ffeead'
        };

        const lineLabels = {
            stipend: 'Actual Stipend',
            buyingPower1990: 'Stipend if inflation calculated from 1990',
            buyingPower2000: 'Stipend if inflation calculated from 1999',
            buyingPower2007: 'Stipend if inflation calculated from 2007',
            buyingPower2015: 'Stipend if inflation calculated from 2015'
        };

        // Tooltip
        const tooltip = d3.select('#tooltip');

        function showTooltip(event, d, metric) {
    const value = d[metric];
    if (value === undefined) return;
    
    let tooltipContent = `
        <strong>Year:</strong> ${d.year}<br>
        <strong>${lineLabels[metric]}:</strong> ₹${value.toLocaleString()}
    `;
    
    // Add difference calculation for buying power metrics (not for actual stipend)
    if (metric !== 'stipend' && d.stipend !== undefined) {
        const difference = value - d.stipend;
        const differenceText = difference > 0 
            ? `₹${difference.toLocaleString()}` 
            : `₹0 (stipend is higher)`;
        
        tooltipContent += `<br><strong>Stipend that you are not getting:</strong> ${differenceText}`;
    }
    
    tooltip
        .style('opacity', 1)
        .style('left', (event.pageX + 10) + 'px')
        .style('top', (event.pageY - 10) + 'px')
        .html(tooltipContent);
}

        function hideTooltip() {
            tooltip.style('opacity', 0);
        }

        function addGrid(svg, xScale, yScale, width, height) {
            // Add vertical grid lines
            svg.append("g")
                .attr("class", "grid")
                .attr("transform", `translate(0,${height})`)
                .call(d3.axisBottom(xScale)
                    .tickSize(-height)
                    .tickFormat("")
                );

            // Add horizontal grid lines
            svg.append("g")
                .attr("class", "grid")
                .attr("transform", `translate(${width},0)`)
                .call(d3.axisRight(yScale)
                    .tickSize(-width)
                    .tickFormat("")
                );
        }

        // 1. Stipend Line Chart
        // function createStipendChart() {
        //     const width = 800;
        //     const height = 300;
        //     const margin = { top: 20, right: 50, bottom: 60, left: 80 };

        //     d3.select('#stipend-chart').selectAll("*").remove();
            
        //     const svg = d3.select('#stipend-chart')
        //                   .attr('width', width + margin.left + margin.right)
        //                   .attr('height', height + margin.top + margin.bottom)
        //                   .append('g')
        //                   .attr('transform', `translate(${margin.left},${margin.top})`);

        //     const xScale = d3.scalePoint()
        //                      .domain(data.map(d => d.year))
        //                      .range([0, width]);

        //     const yScale = d3.scaleLinear()
        //                      .domain([0, d3.max(data, d => d.stipend) * 1.1])
        //                      .range([height, 0]);

        //     const line = d3.line()
        //                   .x(d => xScale(d.year))
        //                   .y(d => yScale(d.stipend));

        //     // Add axes
        //     svg.append('g')
        //        .attr('transform', `translate(0,${height})`)
        //        .call(d3.axisBottom(xScale))
        //        .selectAll('text')
        //        .style('text-anchor', 'end')
        //        .attr('transform', 'rotate(-45)');

        //     svg.append('g')
        //        .call(d3.axisLeft(yScale)
        //            .tickFormat(d => `₹${d.toLocaleString()}`));

        //     // Add axis labels
        //     svg.append('text')
        //        .attr('transform', 'rotate(-90)')
        //        .attr('y', 0 - margin.left)
        //        .attr('x', 0 - (height / 2))
        //        .attr('dy', '1em')
        //        .style('text-anchor', 'middle')
        //        .text('Stipend Amount (₹)');

        //     svg.append('text')
        //        .attr('transform', `translate(${width / 2}, ${height + margin.bottom - 10})`)
        //        .style('text-anchor', 'middle')
        //        .text('Year');

        //     // Add the line
        //     svg.append('path')
        //        .datum(data)
        //        .attr('fill', 'none')
        //        .attr('stroke', colors.stipend)
        //        .attr('stroke-width', 3)
        //        .attr('d', line);

        //     // Add dots with tooltips
        //     svg.selectAll('circle')
        //        .data(data)
        //        .enter()
        //        .append('circle')
        //        .attr('cx', d => xScale(d.year))
        //        .attr('cy', d => yScale(d.stipend))
        //        .attr('r', 4)
        //        .attr('fill', colors.stipend)
        //        .on('mouseover', (event, d) => showTooltip(event, d, 'stipend'))
        //        .on('mouseout', hideTooltip);
        // }

        // 2. Multi-line Chart with All Buying Powers
        function createMultiLineChart(visibleLines = ['all']) {
            const width = 900;
            const height = 400;
            const margin = { top: 20, right: 150, bottom: 60, left: 80 };

            d3.select('#multi-line-chart').selectAll("*").remove();
            
            const svg = d3.select('#multi-line-chart')
                          .attr('width', width + margin.left + margin.right)
                          .attr('height', height + margin.top + margin.bottom)
                          .append('g')
                          .attr('transform', `translate(${margin.left-40},${margin.top})`);

            const xScale = d3.scalePoint()
                             .domain(data.map(d => d.year))
                             .range([0, width]);

            const yScale = d3.scaleLinear()
                             .domain([0, 26000])
                             .range([height, 0]);

            // Add grid lines first (so they appear behind the data)
            addGrid(svg, xScale, yScale, width, height);

            // Add axes
            svg.append('g')
               .attr('transform', `translate(0,${height})`)
               .call(d3.axisBottom(xScale))
               .selectAll('text')
               .style('text-anchor', 'end')
               .attr('transform', 'rotate(-45)');

            svg.append('g')
               .attr('transform', `translate(${width},0)`) 
               .call(d3.axisRight(yScale)
                   .tickFormat(d => `₹${d.toLocaleString()}`));

            // Add axis labels
            svg.append('text')
               .attr('transform', 'rotate(-90)')
               .attr('y', width + margin.right - 100)  // Position on right side
               //.attr('y', 0 - margin.left)
               .attr('x', 0 - (height / 2))
               .attr('dy', '1em')
               .style('text-anchor', 'middle')
               .text('Per Month Amount (₹)')
               .style('fill', 'white');

            svg.append('text')
               .attr('transform', `translate(${width / 2}, ${height + margin.bottom - 10})`)
               .style('text-anchor', 'middle')
               .style('fill', 'white')
               .text('Year');

            // Determine which lines to show
            // const linesToShow = visibleLines[0] === 'all' ? 
            //     ['stipend', 'buyingPower1990', 'buyingPower2000', 'buyingPower2007', 'buyingPower2015'] : 
            //     visibleLines;
            const linesToShow = visibleLines;

            // Add lines
            linesToShow.forEach(metric => {
                const line = d3.line()
                              .defined(d => d[metric] !== undefined)
                              .x(d => xScale(d.year))
                              .y(d => yScale(d[metric]));

                svg.append('path')
                   .datum(data.filter(d => d[metric] !== undefined))
                   .attr('fill', 'none')
                   .attr('stroke', colors[metric])
                   .attr('stroke-width', 2)
                   .attr('d', line);

                // Add dots
                svg.selectAll(`.dots-${metric}`)
                   .data(data.filter(d => d[metric] !== undefined))
                   .enter()
                   .append('circle')
                   .attr('class', `dots-${metric}`)
                   .attr('cx', d => xScale(d.year))
                   .attr('cy', d => yScale(d[metric]))
                   .attr('r', 5)
                   .attr('fill', colors[metric])
                   .on('mouseover', (event, d) => showTooltip(event, d, metric))
                   .on('mouseout', hideTooltip);
            });

            // Update legend
            updateLegend(linesToShow);
        }

        function updateLegend(visibleLines) {
            const legend = d3.select('#legend');
            legend.selectAll('*').remove();

            visibleLines.forEach(metric => {
                const item = legend.append('div').attr('class', 'legend-item');
                item.append('div')
                    .attr('class', 'legend-color')
                    .style('background-color', colors[metric]);
                item.append('span').text(lineLabels[metric]);
            });
        }

        // // 3. Bar Chart for 2024 comparison
        // function createBarChart() {
        //     const width = 600;
        //     const height = 300;
        //     const margin = { top: 20, right: 50, bottom: 100, left: 80 };

        //     d3.select('#bar-chart').selectAll("*").remove();
            
        //     const svg = d3.select('#bar-chart')
        //                   .attr('width', width + margin.left + margin.right)
        //                   .attr('height', height + margin.top + margin.bottom)
        //                   .append('g')
        //                   .attr('transform', `translate(${margin.left},${margin.top})`);

        //     const data2024 = data[data.length - 1];
        //     const barData = [
        //         { category: 'Current\nStipend', value: data2024.stipend, color: colors.stipend },
        //         { category: 'Required for\n1990 Power', value: data2024.buyingPower1990, color: colors.buyingPower1990 },
        //         { category: 'Required for\n2000 Power', value: data2024.buyingPower2000, color: colors.buyingPower2000 },
        //         { category: 'Required for\n2007 Power', value: data2024.buyingPower2007, color: colors.buyingPower2007 },
        //         { category: 'Required for\n2015 Power', value: data2024.buyingPower2015, color: colors.buyingPower2015 }
        //     ];

        //     const xScale = d3.scaleBand()
        //                      .domain(barData.map(d => d.category))
        //                      .range([0, width])
        //                      .padding(0.1);

        //     const yScale = d3.scaleLinear()
        //                      .domain([0, d3.max(barData, d => d.value) * 1.1])
        //                      .range([height, 0]);

        //     // Add axes
        //     svg.append('g')
        //        .attr('transform', `translate(0,${height})`)
        //        .call(d3.axisBottom(xScale))
        //        .selectAll('text')
        //        .style('text-anchor', 'middle')
        //        .style('font-size', '10px');

        //     svg.append('g')
        //        .call(d3.axisLeft(yScale)
        //            .tickFormat(d => `₹${d.toLocaleString()}`));

        //     // Add bars
        //     svg.selectAll('rect')
        //        .data(barData)
        //        .enter()
        //        .append('rect')
        //        .attr('x', d => xScale(d.category))
        //        .attr('y', d => yScale(d.value))
        //        .attr('width', xScale.bandwidth())
        //        .attr('height', d => height - yScale(d.value))
        //        .attr('fill', d => d.color)
        //        .on('mouseover', function(event, d) {
        //            tooltip
        //                .style('opacity', 1)
        //                .style('left', (event.pageX + 10) + 'px')
        //                .style('top', (event.pageY - 10) + 'px')
        //                .html(`<strong>${d.category.replace('\n', ' ')}:</strong><br>₹${d.value.toLocaleString()}`);
        //        })
        //        .on('mouseout', hideTooltip);

        //     // Add value labels on bars
        //     svg.selectAll('.bar-label')
        //        .data(barData)
        //        .enter()
        //        .append('text')
        //        .attr('class', 'bar-label')
        //        .attr('x', d => xScale(d.category) + xScale.bandwidth() / 2)
        //        .attr('y', d => yScale(d.value) - 5)
        //        .attr('text-anchor', 'middle')
        //        .style('font-size', '11px')
        //        .style('fill', 'white')
        //        .text(d => `₹${d.value.toLocaleString()}`);
        // }

        // // Button controls
        // document.addEventListener('DOMContentLoaded', () => {
        //     //createStipendChart();
        //     createMultiLineChart(['all']);
        //     //createBarChart();

        //     // Button event listeners
        //     document.getElementById('btn-all').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['all']);
        //     });

        //     document.getElementById('btn-actual').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['stipend']);
        //     });

        //     document.getElementById('btn-1990').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['stipend', 'buyingPower1990']);
        //     });

        //     document.getElementById('btn-2000').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['stipend', 'buyingPower2000']);
        //     });

        //     document.getElementById('btn-2007').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['stipend', 'buyingPower2007']);
        //     });

        //     document.getElementById('btn-2015').addEventListener('click', function() {
        //         setActiveButton(this);
        //         createMultiLineChart(['stipend', 'buyingPower2015']);
        //     });
        // });

        // function setActiveButton(activeBtn) {
        //     document.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
        //     activeBtn.classList.add('active');
        // }

        // Track which lines are currently visible
let visibleLines = new Set(['stipend', 'buyingPower2000']);

// Button controls
document.addEventListener('DOMContentLoaded', () => {
    // Initialize chart with all lines visible
    createMultiLineChart(Array.from(visibleLines));
    
    // Initialize button states
    updateButtonStates();

    // Button event listeners for individual toggles
    document.getElementById('btn-actual').addEventListener('click', function() {
        toggleLine('stipend', this);
    });

    document.getElementById('btn-1990').addEventListener('click', function() {
        toggleLine('buyingPower1990', this);
    });

    document.getElementById('btn-2000').addEventListener('click', function() {
        toggleLine('buyingPower2000', this);
    });

    document.getElementById('btn-2007').addEventListener('click', function() {
        toggleLine('buyingPower2007', this);
    });

    document.getElementById('btn-2015').addEventListener('click', function() {
        toggleLine('buyingPower2015', this);
    });

    // Special handlers for "All" button
    document.getElementById('btn-all').addEventListener('click', function() {
        toggleAllLines(this);
    });
});

function toggleLine(lineKey, button) {
    if (visibleLines.has(lineKey)) {
        visibleLines.delete(lineKey);
        button.classList.remove('active');
    } else {
        visibleLines.add(lineKey);
        button.classList.add('active');
    }
    
    // Update the "All" button state
    updateAllButtonState();
    
    // Redraw chart with current visible lines
    createMultiLineChart(Array.from(visibleLines));
}

function toggleAllLines(allButton) {
    const allLineKeys = ['stipend', 'buyingPower1990', 'buyingPower2000', 'buyingPower2007', 'buyingPower2015'];
    
    if (visibleLines.size === allLineKeys.length) {
        // All are visible, hide all
        visibleLines.clear();
        allButton.classList.remove('active');
    } else {
        // Some or none are visible, show all
        visibleLines = new Set(allLineKeys);
        allButton.classList.add('active');
    }
    
    // Update individual button states
    updateButtonStates();
    
    // Redraw chart
    createMultiLineChart(Array.from(visibleLines));
}

function updateButtonStates() {
    // Update individual button states
    document.getElementById('btn-actual').classList.toggle('active', visibleLines.has('stipend'));
    document.getElementById('btn-1990').classList.toggle('active', visibleLines.has('buyingPower1990'));
    document.getElementById('btn-2000').classList.toggle('active', visibleLines.has('buyingPower2000'));
    document.getElementById('btn-2007').classList.toggle('active', visibleLines.has('buyingPower2007'));
    document.getElementById('btn-2015').classList.toggle('active', visibleLines.has('buyingPower2015'));
    
    // Update "All" button state
    updateAllButtonState();
}

function updateAllButtonState() {
    const allButton = document.getElementById('btn-all');
    const allLineKeys = ['stipend', 'buyingPower1990', 'buyingPower2000', 'buyingPower2007', 'buyingPower2015'];
    
    // "All" button is active only when all lines are visible
    allButton.classList.toggle('active', visibleLines.size === allLineKeys.length);
}

    </script>
</body>
</html>